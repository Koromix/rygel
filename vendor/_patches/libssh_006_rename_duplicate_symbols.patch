diff --git a/vendor/libssh/include/libssh/curve25519.h b/vendor/libssh/include/libssh/curve25519.h
index e5691157b2..2561122fc9 100644
--- a/vendor/libssh/include/libssh/curve25519.h
+++ b/vendor/libssh/include/libssh/curve25519.h
@@ -29,8 +29,8 @@
 #include <nacl/crypto_scalarmult_curve25519.h>
 #define CURVE25519_PUBKEY_SIZE crypto_scalarmult_curve25519_BYTES
 #define CURVE25519_PRIVKEY_SIZE crypto_scalarmult_curve25519_SCALARBYTES
-#define crypto_scalarmult_base crypto_scalarmult_curve25519_base
-#define crypto_scalarmult crypto_scalarmult_curve25519
+#define _ssh_crypto_scalarmult_base crypto_scalarmult_curve25519_base
+#define _ssh_crypto_scalarmult crypto_scalarmult_curve25519
 #else
 
 #ifdef __cplusplus
@@ -39,8 +39,8 @@ extern "C" {
 
 #define CURVE25519_PUBKEY_SIZE 32
 #define CURVE25519_PRIVKEY_SIZE 32
-int crypto_scalarmult_base(unsigned char *q, const unsigned char *n);
-int crypto_scalarmult(unsigned char *q, const unsigned char *n, const unsigned char *p);
+int _ssh_crypto_scalarmult_base(unsigned char *q, const unsigned char *n);
+int _ssh_crypto_scalarmult(unsigned char *q, const unsigned char *n, const unsigned char *p);
 #endif /* WITH_NACL */
 
 #ifdef HAVE_ECC
diff --git a/vendor/libssh/include/libssh/ed25519.h b/vendor/libssh/include/libssh/ed25519.h
index a6bcdaf3d4..2b62ef6708 100644
--- a/vendor/libssh/include/libssh/ed25519.h
+++ b/vendor/libssh/include/libssh/ed25519.h
@@ -76,7 +76,7 @@ extern "C" {
  * @param[out] sk generated secret key
  * @return     0 on success, -1 on error.
  */
-int crypto_sign_ed25519_keypair(ed25519_pubkey pk, ed25519_privkey sk);
+int _ssh_crypto_sign_ed25519_keypair(ed25519_pubkey pk, ed25519_privkey sk);
 
 /** @internal
  * @brief sign a message with ed25519
@@ -88,7 +88,7 @@ int crypto_sign_ed25519_keypair(ed25519_pubkey pk, ed25519_privkey sk);
  * @param[in] sk secret key to sign the message with
  * @return    0 on success.
  */
-int crypto_sign_ed25519(
+int _ssh_crypto_sign_ed25519(
     unsigned char *sm, uint64_t *smlen,
     const unsigned char *m, uint64_t mlen,
     const ed25519_privkey sk);
@@ -103,7 +103,7 @@ int crypto_sign_ed25519(
  * @param[in] pk public key used to sign the message
  * @returns   0 on success (supposedly).
  */
-int crypto_sign_ed25519_open(
+int _ssh_crypto_sign_ed25519_open(
     unsigned char *m, uint64_t *mlen,
     const unsigned char *sm, uint64_t smlen,
     const ed25519_pubkey pk);
diff --git a/vendor/libssh/include/libssh/wrapper.h b/vendor/libssh/include/libssh/wrapper.h
index 9214a928e9..2da6e2b3d4 100644
--- a/vendor/libssh/include/libssh/wrapper.h
+++ b/vendor/libssh/include/libssh/wrapper.h
@@ -71,35 +71,35 @@ struct ssh_cipher_struct;
 struct ssh_crypto_struct;
 
 typedef struct ssh_mac_ctx_struct *ssh_mac_ctx;
-MD5CTX md5_init(void);
+MD5CTX md5_ctx_init(void);
 void md5_ctx_free(MD5CTX);
-int md5_update(MD5CTX c, const void *data, size_t len);
-int md5_final(unsigned char *md, MD5CTX c);
-int md5(const unsigned char *digest, size_t len, unsigned char *hash);
+int md5_ctx_update(MD5CTX c, const void *data, size_t len);
+int md5_ctx_final(unsigned char *md, MD5CTX c);
+int md5_direct(const unsigned char *digest, size_t len, unsigned char *hash);
 
-SHACTX sha1_init(void);
+SHACTX sha1_ctx_init(void);
 void sha1_ctx_free(SHACTX);
-int sha1_update(SHACTX c, const void *data, size_t len);
-int sha1_final(unsigned char *md,SHACTX c);
-int sha1(const unsigned char *digest,size_t len, unsigned char *hash);
+int sha1_ctx_update(SHACTX c, const void *data, size_t len);
+int sha1_ctx_final(unsigned char *md,SHACTX c);
+int sha1_direct(const unsigned char *digest,size_t len, unsigned char *hash);
 
-SHA256CTX sha256_init(void);
+SHA256CTX sha256_ctx_init(void);
 void sha256_ctx_free(SHA256CTX);
-int sha256_update(SHA256CTX c, const void *data, size_t len);
-int sha256_final(unsigned char *md,SHA256CTX c);
-int sha256(const unsigned char *digest, size_t len, unsigned char *hash);
+int sha256_ctx_update(SHA256CTX c, const void *data, size_t len);
+int sha256_ctx_final(unsigned char *md,SHA256CTX c);
+int sha256_direct(const unsigned char *digest, size_t len, unsigned char *hash);
 
-SHA384CTX sha384_init(void);
+SHA384CTX sha384_ctx_init(void);
 void sha384_ctx_free(SHA384CTX);
-int sha384_update(SHA384CTX c, const void *data, size_t len);
-int sha384_final(unsigned char *md,SHA384CTX c);
-int sha384(const unsigned char *digest, size_t len, unsigned char *hash);
+int sha384_ctx_update(SHA384CTX c, const void *data, size_t len);
+int sha384_ctx_final(unsigned char *md,SHA384CTX c);
+int sha384_direct(const unsigned char *digest, size_t len, unsigned char *hash);
 
-SHA512CTX sha512_init(void);
+SHA512CTX sha512_ctx_init(void);
 void sha512_ctx_free(SHA512CTX);
-int sha512_update(SHA512CTX c, const void *data, size_t len);
-int sha512_final(unsigned char *md,SHA512CTX c);
-int sha512(const unsigned char *digest, size_t len, unsigned char *hash);
+int sha512_ctx_update(SHA512CTX c, const void *data, size_t len);
+int sha512_ctx_final(unsigned char *md,SHA512CTX c);
+int sha512_direct(const unsigned char *digest, size_t len, unsigned char *hash);
 
 HMACCTX hmac_init(const void *key,size_t len, enum ssh_hmac_e type);
 int hmac_update(HMACCTX c, const void *data, size_t len);
diff --git a/vendor/libssh/src/external/bcrypt_pbkdf.c b/vendor/libssh/src/external/bcrypt_pbkdf.c
index b05b87f21e..d49120f803 100644
--- a/vendor/libssh/src/external/bcrypt_pbkdf.c
+++ b/vendor/libssh/src/external/bcrypt_pbkdf.c
@@ -136,9 +136,9 @@ bcrypt_pbkdf(const char *pass, size_t passlen, const uint8_t *salt, size_t saltl
 	}
 
 	/* collapse password */
-	ctx = sha512_init();
-	sha512_update(ctx, pass, passlen);
-	sha512_final(sha2pass, ctx);
+	ctx = sha512_ctx_init();
+	sha512_ctx_update(ctx, pass, passlen);
+	sha512_ctx_final(sha2pass, ctx);
 
 	/* generate key, sizeof(out) at a time */
 	for (count = 1; keylen > 0; count++) {
@@ -148,18 +148,18 @@ bcrypt_pbkdf(const char *pass, size_t passlen, const uint8_t *salt, size_t saltl
 		countsalt[saltlen + 3] = count & 0xff;
 
 		/* first round, salt is salt */
-		ctx = sha512_init();
-		sha512_update(ctx, countsalt, saltlen + 4);
-		sha512_final(sha2salt, ctx);
+		ctx = sha512_ctx_init();
+		sha512_ctx_update(ctx, countsalt, saltlen + 4);
+		sha512_ctx_final(sha2salt, ctx);
 
 		bcrypt_hash(state, sha2pass, sha2salt, tmpout);
 		memcpy(out, tmpout, sizeof(out));
 
 		for (i = 1; i < rounds; i++) {
 			/* subsequent rounds, salt is previous output */
-			ctx = sha512_init();
-			sha512_update(ctx, tmpout, sizeof(tmpout));
-			sha512_final(sha2salt, ctx);
+			ctx = sha512_ctx_init();
+			sha512_ctx_update(ctx, tmpout, sizeof(tmpout));
+			sha512_ctx_final(sha2salt, ctx);
 			bcrypt_hash(state, sha2pass, sha2salt, tmpout);
 			for (j = 0; j < sizeof(out); j++)
 				out[j] ^= tmpout[j];
diff --git a/vendor/libssh/src/external/curve25519_ref.c b/vendor/libssh/src/external/curve25519_ref.c
index 6ffb14a87f..3e6ee2268d 100644
--- a/vendor/libssh/src/external/curve25519_ref.c
+++ b/vendor/libssh/src/external/curve25519_ref.c
@@ -8,10 +8,10 @@ Derived from public domain code by D. J. Bernstein.
 #include "libssh/curve25519.h"
 static const unsigned char base[32] = {9};
 
-int crypto_scalarmult_base(unsigned char *q,
+int _ssh_crypto_scalarmult_base(unsigned char *q,
   const unsigned char *n)
 {
-  return crypto_scalarmult(q,n,base);
+  return _ssh_crypto_scalarmult(q,n,base);
 }
 
 static void add(unsigned int out[32],const unsigned int a[32],const unsigned int b[32])
@@ -250,7 +250,7 @@ static void recip(unsigned int out[32],const unsigned int z[32])
   /* 2^255 - 21 */ mult(out,t1,z11);
 }
 
-int crypto_scalarmult(unsigned char *q,
+int _ssh_crypto_scalarmult(unsigned char *q,
   const unsigned char *n,
   const unsigned char *p)
 {
diff --git a/vendor/libssh/src/external/ed25519.c b/vendor/libssh/src/external/ed25519.c
index 41b5f28985..23c1322e87 100644
--- a/vendor/libssh/src/external/ed25519.c
+++ b/vendor/libssh/src/external/ed25519.c
@@ -71,14 +71,14 @@ static void get_hram(unsigned char *hram,
     for (i = 32;i < 64;++i)    playground[i] = pk[i-32];
     for (i = 64;i < smlen;++i) playground[i] = sm[i];
 
-    ctx = sha512_init();
-    sha512_update(ctx, playground, smlen);
-    sha512_final(hram, ctx);
+    ctx = sha512_ctx_init();
+    sha512_ctx_update(ctx, playground, smlen);
+    sha512_ctx_final(hram, ctx);
 }
 
 
-int crypto_sign_ed25519_keypair(ed25519_pubkey pk,
-                                ed25519_privkey sk)
+int _ssh_crypto_sign_ed25519_keypair(ed25519_pubkey pk,
+                                     ed25519_privkey sk)
 {
     sc25519 scsk;
     ge25519 gepk;
@@ -92,9 +92,9 @@ int crypto_sign_ed25519_keypair(ed25519_pubkey pk,
         return -1;
     }
 
-    ctx = sha512_init();
-    sha512_update(ctx, sk, 32);
-    sha512_final(extsk, ctx);
+    ctx = sha512_ctx_init();
+    sha512_ctx_update(ctx, sk, 32);
+    sha512_ctx_final(extsk, ctx);
     extsk[0] &= 248;
     extsk[31] &= 127;
     extsk[31] |= 64;
@@ -110,11 +110,11 @@ int crypto_sign_ed25519_keypair(ed25519_pubkey pk,
     return 0;
 }
 
-int crypto_sign_ed25519(unsigned char *sm,
-                        uint64_t *smlen,
-                        const unsigned char *m,
-                        uint64_t mlen,
-                        const ed25519_privkey sk)
+int _ssh_crypto_sign_ed25519(unsigned char *sm,
+                             uint64_t *smlen,
+                             const unsigned char *m,
+                             uint64_t mlen,
+                             const ed25519_privkey sk)
 {
     sc25519 sck, scs, scsk;
     ge25519 ger;
@@ -126,9 +126,9 @@ int crypto_sign_ed25519(unsigned char *sm,
     unsigned char hmg[SHA512_DIGEST_LEN];
     unsigned char hram[SHA512_DIGEST_LEN];
 
-    ctx = sha512_init();
-    sha512_update(ctx, sk, 32);
-    sha512_final(extsk, ctx);
+    ctx = sha512_ctx_init();
+    sha512_ctx_update(ctx, sk, 32);
+    sha512_ctx_final(extsk, ctx);
 
     extsk[0] &= 248;
     extsk[31] &= 127;
@@ -143,9 +143,9 @@ int crypto_sign_ed25519(unsigned char *sm,
     }
 
     /* Generate k as h(extsk[32],...,extsk[63],m) */
-    ctx = sha512_init();
-    sha512_update(ctx, sm + 32, mlen + 32);
-    sha512_final(hmg, ctx);
+    ctx = sha512_ctx_init();
+    sha512_ctx_update(ctx, sm + 32, mlen + 32);
+    sha512_ctx_final(hmg, ctx);
 
     /* Computation of R */
     sc25519_from64bytes(&sck, hmg);
@@ -173,11 +173,11 @@ int crypto_sign_ed25519(unsigned char *sm,
     return 0;
 }
 
-int crypto_sign_ed25519_open(unsigned char *m,
-                             uint64_t *mlen,
-                             const unsigned char *sm,
-                             uint64_t smlen,
-                             const ed25519_pubkey pk)
+int _ssh_crypto_sign_ed25519_open(unsigned char *m,
+                                  uint64_t *mlen,
+                                  const unsigned char *sm,
+                                  uint64_t smlen,
+                                  const ed25519_pubkey pk)
 {
     unsigned int i;
     int ret;
diff --git a/vendor/libssh/src/external/sntrup761.c b/vendor/libssh/src/external/sntrup761.c
index 2f45622ddd..f6fba1b0aa 100644
--- a/vendor/libssh/src/external/sntrup761.c
+++ b/vendor/libssh/src/external/sntrup761.c
@@ -27,7 +27,7 @@ sntrup761_enc (uint8_t *c, uint8_t *k, const uint8_t *pk,
 void
 sntrup761_dec (uint8_t *k, const uint8_t *c, const uint8_t *sk);
 
-extern int sha512(const unsigned char *digest, size_t len, unsigned char *hash);
+extern int sha512_direct(const unsigned char *digest, size_t len, unsigned char *hash);
 
 #define MAX_LEN 761
 
@@ -699,7 +699,7 @@ Hash_prefix (unsigned char *out, int b, const unsigned char *in, int inlen)
   x[0] = b;
   for (i = 0; i < inlen; ++i)
     x[i + 1] = in[i];
-  sha512 (x, inlen + 1, h);
+  sha512_direct (x, inlen + 1, h);
   for (i = 0; i < 32; ++i)
     out[i] = h[i];
 }
diff --git a/vendor/libssh/src/hybrid_mlkem.c b/vendor/libssh/src/hybrid_mlkem.c
index 2294561bc9..9c5d0dabd8 100644
--- a/vendor/libssh/src/hybrid_mlkem.c
+++ b/vendor/libssh/src/hybrid_mlkem.c
@@ -128,12 +128,12 @@ static int derive_hybrid_secret(ssh_session session,
     switch (crypto->kex_type) {
     case SSH_KEX_MLKEM768X25519_SHA256:
     case SSH_KEX_MLKEM768NISTP256_SHA256:
-        digest = sha256;
+        digest = sha256_direct;
         digest_len = SHA256_DIGEST_LEN;
         break;
 #ifdef HAVE_MLKEM1024
     case SSH_KEX_MLKEM1024NISTP384_SHA384:
-        digest = sha384;
+        digest = sha384_direct;
         digest_len = SHA384_DIGEST_LEN;
         break;
 #endif
diff --git a/vendor/libssh/src/kdf.c b/vendor/libssh/src/kdf.c
index 6bc477ce76..acd83721bc 100644
--- a/vendor/libssh/src/kdf.c
+++ b/vendor/libssh/src/kdf.c
@@ -60,25 +60,25 @@ static ssh_mac_ctx ssh_mac_ctx_init(enum ssh_kdf_digest type)
     ctx->digest_type = type;
     switch (type) {
     case SSH_KDF_SHA1:
-        ctx->ctx.sha1_ctx = sha1_init();
+        ctx->ctx.sha1_ctx = sha1_ctx_init();
         if (ctx->ctx.sha1_ctx == NULL) {
             goto err;
         }
         return ctx;
     case SSH_KDF_SHA256:
-        ctx->ctx.sha256_ctx = sha256_init();
+        ctx->ctx.sha256_ctx = sha256_ctx_init();
         if (ctx->ctx.sha256_ctx == NULL) {
             goto err;
         }
         return ctx;
     case SSH_KDF_SHA384:
-        ctx->ctx.sha384_ctx = sha384_init();
+        ctx->ctx.sha384_ctx = sha384_ctx_init();
         if (ctx->ctx.sha384_ctx == NULL) {
             goto err;
         }
         return ctx;
     case SSH_KDF_SHA512:
-        ctx->ctx.sha512_ctx = sha512_init();
+        ctx->ctx.sha512_ctx = sha512_ctx_init();
         if (ctx->ctx.sha512_ctx == NULL) {
             goto err;
         }
@@ -116,13 +116,13 @@ static int ssh_mac_update(ssh_mac_ctx ctx, const void *data, size_t len)
 {
     switch (ctx->digest_type) {
     case SSH_KDF_SHA1:
-        return sha1_update(ctx->ctx.sha1_ctx, data, len);
+        return sha1_ctx_update(ctx->ctx.sha1_ctx, data, len);
     case SSH_KDF_SHA256:
-        return sha256_update(ctx->ctx.sha256_ctx, data, len);
+        return sha256_ctx_update(ctx->ctx.sha256_ctx, data, len);
     case SSH_KDF_SHA384:
-        return sha384_update(ctx->ctx.sha384_ctx, data, len);
+        return sha384_ctx_update(ctx->ctx.sha384_ctx, data, len);
     case SSH_KDF_SHA512:
-        return sha512_update(ctx->ctx.sha512_ctx, data, len);
+        return sha512_ctx_update(ctx->ctx.sha512_ctx, data, len);
     }
     return SSH_ERROR;
 }
@@ -133,16 +133,16 @@ static int ssh_mac_final(unsigned char *md, ssh_mac_ctx ctx)
 
     switch (ctx->digest_type) {
     case SSH_KDF_SHA1:
-        rc = sha1_final(md, ctx->ctx.sha1_ctx);
+        rc = sha1_ctx_final(md, ctx->ctx.sha1_ctx);
         break;
     case SSH_KDF_SHA256:
-        rc = sha256_final(md, ctx->ctx.sha256_ctx);
+        rc = sha256_ctx_final(md, ctx->ctx.sha256_ctx);
         break;
     case SSH_KDF_SHA384:
-        rc = sha384_final(md, ctx->ctx.sha384_ctx);
+        rc = sha384_ctx_final(md, ctx->ctx.sha384_ctx);
         break;
     case SSH_KDF_SHA512:
-        rc = sha512_final(md, ctx->ctx.sha512_ctx);
+        rc = sha512_ctx_final(md, ctx->ctx.sha512_ctx);
         break;
     }
     SAFE_FREE(ctx);
diff --git a/vendor/libssh/src/kex.c b/vendor/libssh/src/kex.c
index 1e297891e3..c97e92283c 100644
--- a/vendor/libssh/src/kex.c
+++ b/vendor/libssh/src/kex.c
@@ -1728,7 +1728,7 @@ int ssh_make_sessionid(ssh_session session)
             ssh_set_error_oom(session);
             goto error;
         }
-        sha1(ssh_buffer_get(buf), ssh_buffer_get_len(buf),
+        sha1_direct(ssh_buffer_get(buf), ssh_buffer_get_len(buf),
                                    session->next_crypto->secret_hash);
         break;
     case SSH_KEX_DH_GROUP14_SHA256:
@@ -1750,7 +1750,7 @@ int ssh_make_sessionid(ssh_session session)
             ssh_set_error_oom(session);
             goto error;
         }
-        sha256(ssh_buffer_get(buf), ssh_buffer_get_len(buf),
+        sha256_direct(ssh_buffer_get(buf), ssh_buffer_get_len(buf),
                                      session->next_crypto->secret_hash);
         break;
     case SSH_KEX_ECDH_SHA2_NISTP384:
@@ -1764,7 +1764,7 @@ int ssh_make_sessionid(ssh_session session)
             ssh_set_error_oom(session);
             goto error;
         }
-        sha384(ssh_buffer_get(buf), ssh_buffer_get_len(buf),
+        sha384_direct(ssh_buffer_get(buf), ssh_buffer_get_len(buf),
                                      session->next_crypto->secret_hash);
         break;
     case SSH_KEX_DH_GROUP16_SHA512:
@@ -1780,7 +1780,7 @@ int ssh_make_sessionid(ssh_session session)
             ssh_set_error_oom(session);
             goto error;
         }
-        sha512(ssh_buffer_get(buf),
+        sha512_direct(ssh_buffer_get(buf),
                ssh_buffer_get_len(buf),
                session->next_crypto->secret_hash);
         break;
diff --git a/vendor/libssh/src/libcrypto.c b/vendor/libssh/src/libcrypto.c
index e2e5f93968..00425d58ff 100644
--- a/vendor/libssh/src/libcrypto.c
+++ b/vendor/libssh/src/libcrypto.c
@@ -170,13 +170,13 @@ static const EVP_MD *sshkdf_digest_to_md(enum ssh_kdf_digest digest_type)
 {
     switch (digest_type) {
     case SSH_KDF_SHA1:
-        return EVP_sha1();
+        return EVP_sha1_direct();
     case SSH_KDF_SHA256:
-        return EVP_sha256();
+        return EVP_sha256_direct();
     case SSH_KDF_SHA384:
-        return EVP_sha384();
+        return EVP_sha384_direct();
     case SSH_KDF_SHA512:
-        return EVP_sha512();
+        return EVP_sha512_direct();
     }
     return NULL;
 }
@@ -358,16 +358,16 @@ HMACCTX hmac_init(const void *key, size_t len, enum ssh_hmac_e type)
 
     switch (type) {
     case SSH_HMAC_SHA1:
-        rc = EVP_DigestSignInit(ctx, NULL, EVP_sha1(), NULL, pkey);
+        rc = EVP_DigestSignInit(ctx, NULL, EVP_sha1_direct(), NULL, pkey);
         break;
     case SSH_HMAC_SHA256:
-        rc = EVP_DigestSignInit(ctx, NULL, EVP_sha256(), NULL, pkey);
+        rc = EVP_DigestSignInit(ctx, NULL, EVP_sha256_direct(), NULL, pkey);
         break;
     case SSH_HMAC_SHA512:
-        rc = EVP_DigestSignInit(ctx, NULL, EVP_sha512(), NULL, pkey);
+        rc = EVP_DigestSignInit(ctx, NULL, EVP_sha512_direct(), NULL, pkey);
         break;
     case SSH_HMAC_MD5:
-        rc = EVP_DigestSignInit(ctx, NULL, EVP_md5(), NULL, pkey);
+        rc = EVP_DigestSignInit(ctx, NULL, EVP_md5_direct(), NULL, pkey);
         break;
     default:
         rc = -1;
diff --git a/vendor/libssh/src/md_crypto.c b/vendor/libssh/src/md_crypto.c
index e7b1cf7af3..afd31788ed 100644
--- a/vendor/libssh/src/md_crypto.c
+++ b/vendor/libssh/src/md_crypto.c
@@ -31,14 +31,14 @@
 #include <openssl/sha.h>
 
 SHACTX
-sha1_init(void)
+sha1_ctx_init(void)
 {
     int rc;
     SHACTX c = EVP_MD_CTX_new();
     if (c == NULL) {
         return NULL;
     }
-    rc = EVP_DigestInit_ex(c, EVP_sha1(), NULL);
+    rc = EVP_DigestInit_ex(c, EVP_sha1_direct(), NULL);
     if (rc == 0) {
         EVP_MD_CTX_free(c);
         c = NULL;
@@ -53,7 +53,7 @@ sha1_ctx_free(SHACTX c)
 }
 
 int
-sha1_update(SHACTX c, const void *data, size_t len)
+sha1_ctx_update(SHACTX c, const void *data, size_t len)
 {
     int rc = EVP_DigestUpdate(c, data, len);
     if (rc != 1) {
@@ -63,7 +63,7 @@ sha1_update(SHACTX c, const void *data, size_t len)
 }
 
 int
-sha1_final(unsigned char *md, SHACTX c)
+sha1_ctx_final(unsigned char *md, SHACTX c)
 {
     unsigned int mdlen = 0;
     int rc = EVP_DigestFinal(c, md, &mdlen);
@@ -76,31 +76,31 @@ sha1_final(unsigned char *md, SHACTX c)
 }
 
 int
-sha1(const unsigned char *digest, size_t len, unsigned char *hash)
+sha1_direct(const unsigned char *digest, size_t len, unsigned char *hash)
 {
-    SHACTX c = sha1_init();
+    SHACTX c = sha1_ctx_init();
     int rc;
 
     if (c == NULL) {
         return SSH_ERROR;
     }
-    rc = sha1_update(c, digest, len);
+    rc = sha1_ctx_update(c, digest, len);
     if (rc != SSH_OK) {
         EVP_MD_CTX_free(c);
         return SSH_ERROR;
     }
-    return sha1_final(hash, c);
+    return sha1_ctx_final(hash, c);
 }
 
 SHA256CTX
-sha256_init(void)
+sha256_ctx_init(void)
 {
     int rc;
     SHA256CTX c = EVP_MD_CTX_new();
     if (c == NULL) {
         return NULL;
     }
-    rc = EVP_DigestInit_ex(c, EVP_sha256(), NULL);
+    rc = EVP_DigestInit_ex(c, EVP_sha256_direct(), NULL);
     if (rc == 0) {
         EVP_MD_CTX_free(c);
         c = NULL;
@@ -115,7 +115,7 @@ sha256_ctx_free(SHA256CTX c)
 }
 
 int
-sha256_update(SHA256CTX c, const void *data, size_t len)
+sha256_ctx_update(SHA256CTX c, const void *data, size_t len)
 {
     int rc = EVP_DigestUpdate(c, data, len);
     if (rc != 1) {
@@ -125,7 +125,7 @@ sha256_update(SHA256CTX c, const void *data, size_t len)
 }
 
 int
-sha256_final(unsigned char *md, SHA256CTX c)
+sha256_ctx_final(unsigned char *md, SHA256CTX c)
 {
     unsigned int mdlen = 0;
     int rc = EVP_DigestFinal(c, md, &mdlen);
@@ -138,31 +138,31 @@ sha256_final(unsigned char *md, SHA256CTX c)
 }
 
 int
-sha256(const unsigned char *digest, size_t len, unsigned char *hash)
+sha256_direct(const unsigned char *digest, size_t len, unsigned char *hash)
 {
-    SHA256CTX c = sha256_init();
+    SHA256CTX c = sha256_ctx_init();
     int rc;
 
     if (c == NULL) {
         return SSH_ERROR;
     }
-    rc = sha256_update(c, digest, len);
+    rc = sha256_ctx_update(c, digest, len);
     if (rc != SSH_OK) {
         EVP_MD_CTX_free(c);
         return SSH_ERROR;
     }
-    return sha256_final(hash, c);
+    return sha256_ctx_final(hash, c);
 }
 
 SHA384CTX
-sha384_init(void)
+sha384_ctx_init(void)
 {
     int rc;
     SHA384CTX c = EVP_MD_CTX_new();
     if (c == NULL) {
         return NULL;
     }
-    rc = EVP_DigestInit_ex(c, EVP_sha384(), NULL);
+    rc = EVP_DigestInit_ex(c, EVP_sha384_direct(), NULL);
     if (rc == 0) {
         EVP_MD_CTX_free(c);
         c = NULL;
@@ -177,7 +177,7 @@ sha384_ctx_free(SHA384CTX c)
 }
 
 int
-sha384_update(SHA384CTX c, const void *data, size_t len)
+sha384_ctx_update(SHA384CTX c, const void *data, size_t len)
 {
     int rc = EVP_DigestUpdate(c, data, len);
     if (rc != 1) {
@@ -187,7 +187,7 @@ sha384_update(SHA384CTX c, const void *data, size_t len)
 }
 
 int
-sha384_final(unsigned char *md, SHA384CTX c)
+sha384_ctx_final(unsigned char *md, SHA384CTX c)
 {
     unsigned int mdlen = 0;
     int rc = EVP_DigestFinal(c, md, &mdlen);
@@ -200,31 +200,31 @@ sha384_final(unsigned char *md, SHA384CTX c)
 }
 
 int
-sha384(const unsigned char *digest, size_t len, unsigned char *hash)
+sha384_direct(const unsigned char *digest, size_t len, unsigned char *hash)
 {
-    SHA384CTX c = sha384_init();
+    SHA384CTX c = sha384_ctx_init();
     int rc;
 
     if (c == NULL) {
         return SSH_ERROR;
     }
-    rc = sha384_update(c, digest, len);
+    rc = sha384_ctx_update(c, digest, len);
     if (rc != SSH_OK) {
         EVP_MD_CTX_free(c);
         return SSH_ERROR;
     }
-    return sha384_final(hash, c);
+    return sha384_ctx_final(hash, c);
 }
 
 SHA512CTX
-sha512_init(void)
+sha512_ctx_init(void)
 {
     int rc = 0;
     SHA512CTX c = EVP_MD_CTX_new();
     if (c == NULL) {
         return NULL;
     }
-    rc = EVP_DigestInit_ex(c, EVP_sha512(), NULL);
+    rc = EVP_DigestInit_ex(c, EVP_sha512_direct(), NULL);
     if (rc == 0) {
         EVP_MD_CTX_free(c);
         c = NULL;
@@ -239,7 +239,7 @@ sha512_ctx_free(SHA512CTX c)
 }
 
 int
-sha512_update(SHA512CTX c, const void *data, size_t len)
+sha512_ctx_update(SHA512CTX c, const void *data, size_t len)
 {
     int rc = EVP_DigestUpdate(c, data, len);
     if (rc != 1) {
@@ -249,7 +249,7 @@ sha512_update(SHA512CTX c, const void *data, size_t len)
 }
 
 int
-sha512_final(unsigned char *md, SHA512CTX c)
+sha512_ctx_final(unsigned char *md, SHA512CTX c)
 {
     unsigned int mdlen = 0;
     int rc = EVP_DigestFinal(c, md, &mdlen);
@@ -262,31 +262,31 @@ sha512_final(unsigned char *md, SHA512CTX c)
 }
 
 int
-sha512(const unsigned char *digest, size_t len, unsigned char *hash)
+sha512_direct(const unsigned char *digest, size_t len, unsigned char *hash)
 {
-    SHA512CTX c = sha512_init();
+    SHA512CTX c = sha512_ctx_init();
     int rc;
 
     if (c == NULL) {
         return SSH_ERROR;
     }
-    rc = sha512_update(c, digest, len);
+    rc = sha512_ctx_update(c, digest, len);
     if (rc != SSH_OK) {
         EVP_MD_CTX_free(c);
         return SSH_ERROR;
     }
-    return sha512_final(hash, c);
+    return sha512_ctx_final(hash, c);
 }
 
 MD5CTX
-md5_init(void)
+md5_ctx_init(void)
 {
     int rc;
     MD5CTX c = EVP_MD_CTX_new();
     if (c == NULL) {
         return NULL;
     }
-    rc = EVP_DigestInit_ex(c, EVP_md5(), NULL);
+    rc = EVP_DigestInit_ex(c, EVP_md5_direct(), NULL);
     if (rc == 0) {
         EVP_MD_CTX_free(c);
         c = NULL;
@@ -301,7 +301,7 @@ md5_ctx_free(MD5CTX c)
 }
 
 int
-md5_update(MD5CTX c, const void *data, size_t len)
+md5_ctx_update(MD5CTX c, const void *data, size_t len)
 {
     int rc = EVP_DigestUpdate(c, data, len);
     if (rc != 1) {
@@ -311,7 +311,7 @@ md5_update(MD5CTX c, const void *data, size_t len)
 }
 
 int
-md5_final(unsigned char *md, MD5CTX c)
+md5_ctx_final(unsigned char *md, MD5CTX c)
 {
     unsigned int mdlen = 0;
     int rc = EVP_DigestFinal(c, md, &mdlen);
@@ -327,7 +327,7 @@ md5_final(unsigned char *md, MD5CTX c)
 * @ brief One-shot MD5. Not intended for use in security-relevant contexts.
 */
 int
-md5(const unsigned char *digest, size_t len, unsigned char *hash)
+md5_direct(const unsigned char *digest, size_t len, unsigned char *hash)
 {
     int rc, ret = SSH_ERROR;
     unsigned int mdlen = 0;
diff --git a/vendor/libssh/src/md_gcrypt.c b/vendor/libssh/src/md_gcrypt.c
index c8830773e2..61b5371c2c 100644
--- a/vendor/libssh/src/md_gcrypt.c
+++ b/vendor/libssh/src/md_gcrypt.c
@@ -28,7 +28,7 @@
 #include <gcrypt.h>
 
 SHACTX
-sha1_init(void)
+sha1_ctx_init(void)
 {
     SHACTX ctx = NULL;
     gcry_md_open(&ctx, GCRY_MD_SHA1, 0);
@@ -37,7 +37,7 @@ sha1_init(void)
 }
 
 int
-sha1_update(SHACTX c, const void *data, size_t len)
+sha1_ctx_update(SHACTX c, const void *data, size_t len)
 {
     gcry_md_write(c, data, len);
     return SSH_OK;
@@ -50,7 +50,7 @@ sha1_ctx_free(SHACTX c)
 }
 
 int
-sha1_final(unsigned char *md, SHACTX c)
+sha1_ctx_final(unsigned char *md, SHACTX c)
 {
     unsigned char *tmp = NULL;
 
@@ -66,14 +66,14 @@ sha1_final(unsigned char *md, SHACTX c)
 }
 
 int
-sha1(const unsigned char *digest, size_t len, unsigned char *hash)
+sha1_direct(const unsigned char *digest, size_t len, unsigned char *hash)
 {
     gcry_md_hash_buffer(GCRY_MD_SHA1, hash, digest, len);
     return SSH_OK;
 }
 
 SHA256CTX
-sha256_init(void)
+sha256_ctx_init(void)
 {
     SHA256CTX ctx = NULL;
     gcry_md_open(&ctx, GCRY_MD_SHA256, 0);
@@ -88,14 +88,14 @@ sha256_ctx_free(SHA256CTX c)
 }
 
 int
-sha256_update(SHACTX c, const void *data, size_t len)
+sha256_ctx_update(SHACTX c, const void *data, size_t len)
 {
     gcry_md_write(c, data, len);
     return SSH_OK;
 }
 
 int
-sha256_final(unsigned char *md, SHACTX c)
+sha256_ctx_final(unsigned char *md, SHACTX c)
 {
     unsigned char *tmp = NULL;
 
@@ -111,14 +111,14 @@ sha256_final(unsigned char *md, SHACTX c)
 }
 
 int
-sha256(const unsigned char *digest, size_t len, unsigned char *hash)
+sha256_direct(const unsigned char *digest, size_t len, unsigned char *hash)
 {
     gcry_md_hash_buffer(GCRY_MD_SHA256, hash, digest, len);
     return SSH_OK;
 }
 
 SHA384CTX
-sha384_init(void)
+sha384_ctx_init(void)
 {
     SHA384CTX ctx = NULL;
     gcry_md_open(&ctx, GCRY_MD_SHA384, 0);
@@ -133,14 +133,14 @@ sha384_ctx_free(SHA384CTX c)
 }
 
 int
-sha384_update(SHACTX c, const void *data, size_t len)
+sha384_ctx_update(SHACTX c, const void *data, size_t len)
 {
     gcry_md_write(c, data, len);
     return SSH_OK;
 }
 
 int
-sha384_final(unsigned char *md, SHACTX c)
+sha384_ctx_final(unsigned char *md, SHACTX c)
 {
     unsigned char *tmp = NULL;
 
@@ -156,14 +156,14 @@ sha384_final(unsigned char *md, SHACTX c)
 }
 
 int
-sha384(const unsigned char *digest, size_t len, unsigned char *hash)
+sha384_direct(const unsigned char *digest, size_t len, unsigned char *hash)
 {
     gcry_md_hash_buffer(GCRY_MD_SHA384, hash, digest, len);
     return SSH_OK;
 }
 
 SHA512CTX
-sha512_init(void)
+sha512_ctx_init(void)
 {
     SHA512CTX ctx = NULL;
     gcry_md_open(&ctx, GCRY_MD_SHA512, 0);
@@ -178,14 +178,14 @@ sha512_ctx_free(SHA512CTX c)
 }
 
 int
-sha512_update(SHACTX c, const void *data, size_t len)
+sha512_ctx_update(SHACTX c, const void *data, size_t len)
 {
     gcry_md_write(c, data, len);
     return SSH_OK;
 }
 
 int
-sha512_final(unsigned char *md, SHACTX c)
+sha512_ctx_final(unsigned char *md, SHACTX c)
 {
     unsigned char *tmp = NULL;
 
@@ -201,14 +201,14 @@ sha512_final(unsigned char *md, SHACTX c)
 }
 
 int
-sha512(const unsigned char *digest, size_t len, unsigned char *hash)
+sha512_direct(const unsigned char *digest, size_t len, unsigned char *hash)
 {
     gcry_md_hash_buffer(GCRY_MD_SHA512, hash, digest, len);
     return SSH_OK;
 }
 
 MD5CTX
-md5_init(void)
+md5_ctx_init(void)
 {
     MD5CTX c = NULL;
     gcry_md_open(&c, GCRY_MD_MD5, 0);
@@ -223,14 +223,14 @@ md5_ctx_free(MD5CTX c)
 }
 
 int
-md5_update(MD5CTX c, const void *data, size_t len)
+md5_ctx_update(MD5CTX c, const void *data, size_t len)
 {
     gcry_md_write(c, data, len);
     return SSH_OK;
 }
 
 int
-md5_final(unsigned char *md, MD5CTX c)
+md5_ctx_final(unsigned char *md, MD5CTX c)
 {
     unsigned char *tmp = NULL;
 
@@ -245,7 +245,7 @@ md5_final(unsigned char *md, MD5CTX c)
     return SSH_OK;
 }
 
-int md5(const unsigned char *digest, size_t len, unsigned char *hash)
+int md5_direct(const unsigned char *digest, size_t len, unsigned char *hash)
 {
     gcry_md_hash_buffer(GCRY_MD_MD5, hash, digest, len);
     return SSH_OK;
diff --git a/vendor/libssh/src/md_mbedcrypto.c b/vendor/libssh/src/md_mbedcrypto.c
index 445f644da1..ea7fa8b013 100644
--- a/vendor/libssh/src/md_mbedcrypto.c
+++ b/vendor/libssh/src/md_mbedcrypto.c
@@ -30,7 +30,7 @@
 #include <mbedtls/md.h>
 
 SHACTX
-sha1_init(void)
+sha1_ctx_init(void)
 {
     SHACTX ctx = NULL;
     int rc;
@@ -71,7 +71,7 @@ sha1_ctx_free(SHACTX c)
 }
 
 int
-sha1_update(SHACTX c, const void *data, size_t len)
+sha1_ctx_update(SHACTX c, const void *data, size_t len)
 {
     int rc = mbedtls_md_update(c, data, len);
     if (rc != 0) {
@@ -81,7 +81,7 @@ sha1_update(SHACTX c, const void *data, size_t len)
 }
 
 int
-sha1_final(unsigned char *md, SHACTX c)
+sha1_ctx_final(unsigned char *md, SHACTX c)
 {
     int rc = mbedtls_md_finish(c, md);
     sha1_ctx_free(c);
@@ -92,7 +92,7 @@ sha1_final(unsigned char *md, SHACTX c)
 }
 
 int
-sha1(const unsigned char *digest, size_t len, unsigned char *hash)
+sha1_direct(const unsigned char *digest, size_t len, unsigned char *hash)
 {
     const mbedtls_md_info_t *md_info =
         mbedtls_md_info_from_type(MBEDTLS_MD_SHA1);
@@ -109,7 +109,7 @@ sha1(const unsigned char *digest, size_t len, unsigned char *hash)
 }
 
 SHA256CTX
-sha256_init(void)
+sha256_ctx_init(void)
 {
     SHA256CTX ctx = NULL;
     int rc;
@@ -150,7 +150,7 @@ sha256_ctx_free(SHA256CTX c)
 }
 
 int
-sha256_update(SHA256CTX c, const void *data, size_t len)
+sha256_ctx_update(SHA256CTX c, const void *data, size_t len)
 {
     int rc = mbedtls_md_update(c, data, len);
     if (rc != 0) {
@@ -160,7 +160,7 @@ sha256_update(SHA256CTX c, const void *data, size_t len)
 }
 
 int
-sha256_final(unsigned char *md, SHA256CTX c)
+sha256_ctx_final(unsigned char *md, SHA256CTX c)
 {
     int rc = mbedtls_md_finish(c, md);
     mbedtls_md_free(c);
@@ -172,7 +172,7 @@ sha256_final(unsigned char *md, SHA256CTX c)
 }
 
 int
-sha256(const unsigned char *digest, size_t len, unsigned char *hash)
+sha256_direct(const unsigned char *digest, size_t len, unsigned char *hash)
 {
     int rc;
     const mbedtls_md_info_t *md_info =
@@ -188,7 +188,7 @@ sha256(const unsigned char *digest, size_t len, unsigned char *hash)
 }
 
 SHA384CTX
-sha384_init(void)
+sha384_ctx_init(void)
 {
     SHA384CTX ctx = NULL;
     int rc;
@@ -229,7 +229,7 @@ sha384_ctx_free(SHA384CTX c)
 }
 
 int
-sha384_update(SHA384CTX c, const void *data, size_t len)
+sha384_ctx_update(SHA384CTX c, const void *data, size_t len)
 {
     int rc = mbedtls_md_update(c, data, len);
     if (rc != 0) {
@@ -239,7 +239,7 @@ sha384_update(SHA384CTX c, const void *data, size_t len)
 }
 
 int
-sha384_final(unsigned char *md, SHA384CTX c)
+sha384_ctx_final(unsigned char *md, SHA384CTX c)
 {
     int rc = mbedtls_md_finish(c, md);
     sha384_ctx_free(c);
@@ -250,7 +250,7 @@ sha384_final(unsigned char *md, SHA384CTX c)
 }
 
 int
-sha384(const unsigned char *digest, size_t len, unsigned char *hash)
+sha384_direct(const unsigned char *digest, size_t len, unsigned char *hash)
 {
     const mbedtls_md_info_t *md_info =
         mbedtls_md_info_from_type(MBEDTLS_MD_SHA384);
@@ -267,7 +267,7 @@ sha384(const unsigned char *digest, size_t len, unsigned char *hash)
 }
 
 SHA512CTX
-sha512_init(void)
+sha512_ctx_init(void)
 {
     SHA512CTX ctx = NULL;
     int rc;
@@ -307,7 +307,7 @@ sha512_ctx_free(SHA512CTX c)
 }
 
 int
-sha512_update(SHA512CTX c, const void *data, size_t len)
+sha512_ctx_update(SHA512CTX c, const void *data, size_t len)
 {
     int rc = mbedtls_md_update(c, data, len);
     if (rc != 0) {
@@ -317,7 +317,7 @@ sha512_update(SHA512CTX c, const void *data, size_t len)
 }
 
 int
-sha512_final(unsigned char *md, SHA512CTX c)
+sha512_ctx_final(unsigned char *md, SHA512CTX c)
 {
     int rc = mbedtls_md_finish(c, md);
     sha512_ctx_free(c);
@@ -328,7 +328,7 @@ sha512_final(unsigned char *md, SHA512CTX c)
 }
 
 int
-sha512(const unsigned char *digest, size_t len, unsigned char *hash)
+sha512_direct(const unsigned char *digest, size_t len, unsigned char *hash)
 {
     const mbedtls_md_info_t *md_info =
         mbedtls_md_info_from_type(MBEDTLS_MD_SHA512);
@@ -345,7 +345,7 @@ sha512(const unsigned char *digest, size_t len, unsigned char *hash)
 }
 
 MD5CTX
-md5_init(void)
+md5_ctx_init(void)
 {
     MD5CTX ctx = NULL;
     int rc;
@@ -385,7 +385,7 @@ md5_ctx_free(MD5CTX c)
 }
 
 int
-md5_update(MD5CTX c, const void *data, size_t len)
+md5_ctx_update(MD5CTX c, const void *data, size_t len)
 {
     int rc = mbedtls_md_update(c, data, len);
     if (rc != 0) {
@@ -395,7 +395,7 @@ md5_update(MD5CTX c, const void *data, size_t len)
 }
 
 int
-md5_final(unsigned char *md, MD5CTX c)
+md5_ctx_final(unsigned char *md, MD5CTX c)
 {
     int rc = mbedtls_md_finish(c, md);
     mbedtls_md_free(c);
@@ -406,7 +406,7 @@ md5_final(unsigned char *md, MD5CTX c)
     return SSH_OK;
 }
 
-int md5(const unsigned char *digest, size_t len, unsigned char *hash)
+int md5_direct(const unsigned char *digest, size_t len, unsigned char *hash)
 {
     MD5CTX ctx = NULL;
     int rc;
diff --git a/vendor/libssh/src/misc.c b/vendor/libssh/src/misc.c
index 2518a9519e..378ec8265e 100644
--- a/vendor/libssh/src/misc.c
+++ b/vendor/libssh/src/misc.c
@@ -1261,7 +1261,7 @@ static char *get_connection_hash(ssh_session session)
 {
     unsigned char conn_hash[SHA_DIGEST_LENGTH];
     char *local_hostname = NULL;
-    SHACTX ctx = sha1_init();
+    SHACTX ctx = sha1_ctx_init();
     char strport[10] = {0};
     unsigned int port;
     char *username = NULL;
@@ -1280,7 +1280,7 @@ static char *get_connection_hash(ssh_session session)
     if (local_hostname == NULL) {
         goto err;
     }
-    rc = sha1_update(ctx, local_hostname, strlen(local_hostname));
+    rc = sha1_ctx_update(ctx, local_hostname, strlen(local_hostname));
     if (rc != SSH_OK) {
         goto err;
     }
@@ -1290,7 +1290,7 @@ static char *get_connection_hash(ssh_session session)
     if (session->opts.host == NULL) {
         goto err;
     }
-    rc = sha1_update(ctx, session->opts.host, strlen(session->opts.host));
+    rc = sha1_ctx_update(ctx, session->opts.host, strlen(session->opts.host));
     if (rc != SSH_OK) {
         goto err;
     }
@@ -1298,7 +1298,7 @@ static char *get_connection_hash(ssh_session session)
     /* Remote port %p */
     ssh_options_get_port(session, &port);
     snprintf(strport, sizeof(strport), "%d", port);
-    rc = sha1_update(ctx, strport, strlen(strport));
+    rc = sha1_ctx_update(ctx, strport, strlen(strport));
     if (rc != SSH_OK) {
         goto err;
     }
@@ -1312,7 +1312,7 @@ static char *get_connection_hash(ssh_session session)
             goto err;
         }
     }
-    rc = sha1_update(ctx, username, strlen(username));
+    rc = sha1_ctx_update(ctx, username, strlen(username));
     if (username != session->opts.username) {
         free(username);
     }
@@ -1322,16 +1322,16 @@ static char *get_connection_hash(ssh_session session)
 
     /* ProxyJump */
     if (session->opts.proxy_jumps_str != NULL) {
-        rc = sha1_update(ctx,
-                         session->opts.proxy_jumps_str,
-                         strlen(session->opts.proxy_jumps_str));
+        rc = sha1_ctx_update(ctx,
+                             session->opts.proxy_jumps_str,
+                             strlen(session->opts.proxy_jumps_str));
     }
     if (rc != SSH_OK) {
         goto err;
     }
 
     /* Frees context */
-    rc = sha1_final(conn_hash, ctx);
+    rc = sha1_ctx_final(conn_hash, ctx);
     if (rc != SSH_OK) {
         goto err;
     }
diff --git a/vendor/libssh/src/pki.c b/vendor/libssh/src/pki.c
index ef90df235c..76fde83837 100644
--- a/vendor/libssh/src/pki.c
+++ b/vendor/libssh/src/pki.c
@@ -3049,24 +3049,24 @@ int pki_sk_signature_buffer_prepare(const ssh_key key,
     *sk_buffer_out = NULL;
 
     /* Calculate application hash */
-    ctx = sha256_init();
+    ctx = sha256_ctx_init();
     if (ctx == NULL) {
         SSH_LOG(SSH_LOG_TRACE, "Can not create SHA256CTX for application hash");
         return SSH_ERROR;
     }
-    sha256_update(ctx,
+    sha256_ctx_update(ctx,
                   ssh_string_data(key->sk_application),
                   ssh_string_len(key->sk_application));
-    sha256_final(application_hash, ctx);
+    sha256_ctx_final(application_hash, ctx);
 
     /* Calculate input hash */
-    ctx = sha256_init();
+    ctx = sha256_ctx_init();
     if (ctx == NULL) {
         SSH_LOG(SSH_LOG_TRACE, "Can not create SHA256CTX for input hash");
         goto out;
     }
-    sha256_update(ctx, input, input_len);
-    sha256_final(input_hash, ctx);
+    sha256_ctx_update(ctx, input, input_len);
+    sha256_ctx_final(input_hash, ctx);
 
     /* Create and pack the sk_buffer */
     sk_buffer = ssh_buffer_new();
@@ -3366,10 +3366,10 @@ static int sshsig_prepare_data(const void *data,
 
     if (strcmp(hash_alg, "sha256") == 0) {
         hash_len = SHA256_DIGEST_LEN;
-        rc = sha256(data, data_length, (unsigned char *)hash);
+        rc = sha256_direct(data, data_length, (unsigned char *)hash);
     } else if (strcmp(hash_alg, "sha512") == 0) {
         hash_len = SHA512_DIGEST_LEN;
-        rc = sha512(data, data_length, (unsigned char *)hash);
+        rc = sha512_direct(data, data_length, (unsigned char *)hash);
     } else {
         SSH_LOG(SSH_LOG_TRACE, "Unsupported hash algorithm: %s", hash_alg);
         goto cleanup;
diff --git a/vendor/libssh/src/pki_crypto.c b/vendor/libssh/src/pki_crypto.c
index 7bb5b64473..1640b1d946 100644
--- a/vendor/libssh/src/pki_crypto.c
+++ b/vendor/libssh/src/pki_crypto.c
@@ -2460,16 +2460,16 @@ static const EVP_MD *pki_digest_to_md(enum ssh_digest_e hash_type)
 
     switch (hash_type) {
     case SSH_DIGEST_SHA256:
-        md = EVP_sha256();
+        md = EVP_sha256_direct();
         break;
     case SSH_DIGEST_SHA384:
-        md = EVP_sha384();
+        md = EVP_sha384_direct();
         break;
     case SSH_DIGEST_SHA512:
-        md = EVP_sha512();
+        md = EVP_sha512_direct();
         break;
     case SSH_DIGEST_SHA1:
-        md = EVP_sha1();
+        md = EVP_sha1_direct();
         break;
     case SSH_DIGEST_AUTO:
         md = NULL;
diff --git a/vendor/libssh/src/pki_ed25519.c b/vendor/libssh/src/pki_ed25519.c
index f395406451..eb8aded95d 100644
--- a/vendor/libssh/src/pki_ed25519.c
+++ b/vendor/libssh/src/pki_ed25519.c
@@ -241,8 +241,8 @@ int pki_key_generate_ed25519(ssh_key key)
         goto error;
     }
 
-    rc = crypto_sign_ed25519_keypair(*key->ed25519_pubkey,
-                                     *key->ed25519_privkey);
+    rc = _ssh_crypto_sign_ed25519_keypair(*key->ed25519_pubkey,
+                                          *key->ed25519_privkey);
     if (rc != 0) {
         goto error;
     }
@@ -269,11 +269,11 @@ int pki_ed25519_sign(const ssh_key privkey,
         return SSH_ERROR;
     }
 
-    rc = crypto_sign_ed25519(buffer,
-                             &dlen,
-                             hash,
-                             hlen,
-                             *privkey->ed25519_privkey);
+    rc = _ssh_crypto_sign_ed25519(buffer,
+                                  &dlen,
+                                  hash,
+                                  hlen,
+                                 *privkey->ed25519_privkey);
     if (rc != 0) {
         goto error;
     }
@@ -325,11 +325,11 @@ int pki_ed25519_verify(const ssh_key pubkey,
     memcpy(buffer, sig->ed25519_sig, ED25519_SIG_LEN);
     memcpy(buffer + ED25519_SIG_LEN, hash, hlen);
 
-    rc = crypto_sign_ed25519_open(buffer2,
-                                  &mlen,
-                                  buffer,
-                                  hlen + ED25519_SIG_LEN,
-                                  *pubkey->ed25519_pubkey);
+    rc = _ssh_crypto_sign_ed25519_open(buffer2,
+                                       &mlen,
+                                       buffer,
+                                       hlen + ED25519_SIG_LEN,
+                                       *pubkey->ed25519_pubkey);
 
     ssh_burn(buffer, hlen + ED25519_SIG_LEN);
     ssh_burn(buffer2, hlen);
diff --git a/vendor/libssh/src/pki_gcrypt.c b/vendor/libssh/src/pki_gcrypt.c
index 802fa7e2bc..62ac8e5619 100644
--- a/vendor/libssh/src/pki_gcrypt.c
+++ b/vendor/libssh/src/pki_gcrypt.c
@@ -2139,22 +2139,22 @@ ssh_signature pki_sign_data(const ssh_key privkey,
 
     switch (hash_type) {
     case SSH_DIGEST_SHA256:
-        sha256(input, input_len, hash);
+        sha256_direct(input, input_len, hash);
         hlen = SHA256_DIGEST_LEN;
         sign_input = hash;
         break;
     case SSH_DIGEST_SHA384:
-        sha384(input, input_len, hash);
+        sha384_direct(input, input_len, hash);
         hlen = SHA384_DIGEST_LEN;
         sign_input = hash;
         break;
     case SSH_DIGEST_SHA512:
-        sha512(input, input_len, hash);
+        sha512_direct(input, input_len, hash);
         hlen = SHA512_DIGEST_LEN;
         sign_input = hash;
         break;
     case SSH_DIGEST_SHA1:
-        sha1(input, input_len, hash);
+        sha1_direct(input, input_len, hash);
         hlen = SHA_DIGEST_LEN;
         sign_input = hash;
         break;
@@ -2222,25 +2222,25 @@ int pki_verify_data_signature(ssh_signature signature,
 
     switch (signature->hash_type) {
     case SSH_DIGEST_SHA256:
-        sha256(input, input_len, hash);
+        sha256_direct(input, input_len, hash);
         hlen = SHA256_DIGEST_LEN;
         hash_type = "sha256";
         verify_input = hash;
         break;
     case SSH_DIGEST_SHA384:
-        sha384(input, input_len, hash);
+        sha384_direct(input, input_len, hash);
         hlen = SHA384_DIGEST_LEN;
         hash_type = "sha384";
         verify_input = hash;
         break;
     case SSH_DIGEST_SHA512:
-        sha512(input, input_len, hash);
+        sha512_direct(input, input_len, hash);
         hlen = SHA512_DIGEST_LEN;
         hash_type = "sha512";
         verify_input = hash;
         break;
     case SSH_DIGEST_SHA1:
-        sha1(input, input_len, hash);
+        sha1_direct(input, input_len, hash);
         hlen = SHA_DIGEST_LEN;
         hash_type = "sha1";
         verify_input = hash;
diff --git a/vendor/libssh/src/pki_mbedcrypto.c b/vendor/libssh/src/pki_mbedcrypto.c
index 01a9ca80fc..046aac03dc 100644
--- a/vendor/libssh/src/pki_mbedcrypto.c
+++ b/vendor/libssh/src/pki_mbedcrypto.c
@@ -1602,22 +1602,22 @@ ssh_signature pki_sign_data(const ssh_key privkey,
 
     switch (hash_type) {
     case SSH_DIGEST_SHA256:
-        sha256(input, input_len, hash);
+        sha256_direct(input, input_len, hash);
         hlen = SHA256_DIGEST_LEN;
         sign_input = hash;
         break;
     case SSH_DIGEST_SHA384:
-        sha384(input, input_len, hash);
+        sha384_direct(input, input_len, hash);
         hlen = SHA384_DIGEST_LEN;
         sign_input = hash;
         break;
     case SSH_DIGEST_SHA512:
-        sha512(input, input_len, hash);
+        sha512_direct(input, input_len, hash);
         hlen = SHA512_DIGEST_LEN;
         sign_input = hash;
         break;
     case SSH_DIGEST_SHA1:
-        sha1(input, input_len, hash);
+        sha1_direct(input, input_len, hash);
         hlen = SHA_DIGEST_LEN;
         sign_input = hash;
         break;
@@ -1681,25 +1681,25 @@ int pki_verify_data_signature(ssh_signature signature,
 
     switch (signature->hash_type) {
     case SSH_DIGEST_SHA256:
-        sha256(input, input_len, hash);
+        sha256_direct(input, input_len, hash);
         hlen = SHA256_DIGEST_LEN;
         md = MBEDTLS_MD_SHA256;
         verify_input = hash;
         break;
     case SSH_DIGEST_SHA384:
-        sha384(input, input_len, hash);
+        sha384_direct(input, input_len, hash);
         hlen = SHA384_DIGEST_LEN;
         md = MBEDTLS_MD_SHA384;
         verify_input = hash;
         break;
     case SSH_DIGEST_SHA512:
-        sha512(input, input_len, hash);
+        sha512_direct(input, input_len, hash);
         hlen = SHA512_DIGEST_LEN;
         md = MBEDTLS_MD_SHA512;
         verify_input = hash;
         break;
     case SSH_DIGEST_SHA1:
-        sha1(input, input_len, hash);
+        sha1_direct(input, input_len, hash);
         hlen = SHA_DIGEST_LEN;
         md = MBEDTLS_MD_SHA1;
         verify_input = hash;
diff --git a/vendor/libssh/src/session.c b/vendor/libssh/src/session.c
index 8e4ef0d4db..9615fd3dd2 100644
--- a/vendor/libssh/src/session.c
+++ b/vendor/libssh/src/session.c
@@ -1208,16 +1208,16 @@ int ssh_get_pubkey_hash(ssh_session session, unsigned char **hash)
         return SSH_ERROR;
     }
 
-    ctx = md5_init();
+    ctx = md5_ctx_init();
     if (ctx == NULL) {
         SSH_STRING_FREE(pubkey_blob);
         SAFE_FREE(h);
         return SSH_ERROR;
     }
 
-    rc = md5_update(ctx,
-                    ssh_string_data(pubkey_blob),
-                    ssh_string_len(pubkey_blob));
+    rc = md5_ctx_update(ctx,
+                        ssh_string_data(pubkey_blob),
+                        ssh_string_len(pubkey_blob));
     if (rc != SSH_OK) {
         SSH_STRING_FREE(pubkey_blob);
         md5_ctx_free(ctx);
@@ -1225,7 +1225,7 @@ int ssh_get_pubkey_hash(ssh_session session, unsigned char **hash)
         return rc;
     }
     SSH_STRING_FREE(pubkey_blob);
-    rc = md5_final(h, ctx);
+    rc = md5_ctx_final(h, ctx);
     if (rc != SSH_OK) {
         SAFE_FREE(h);
         return rc;
@@ -1335,11 +1335,11 @@ int ssh_get_publickey_hash(const ssh_key key,
 
     switch (type) {
     case SSH_PUBLICKEY_HASH_SHA1:
-        digest = sha1;
+        digest = sha1_direct;
         *hlen = SHA_DIGEST_LEN;
         break;
     case SSH_PUBLICKEY_HASH_SHA256:
-        digest = sha256;
+        digest = sha256_direct;
         *hlen = SHA256_DIGEST_LEN;
         break;
     case SSH_PUBLICKEY_HASH_MD5:
@@ -1352,7 +1352,7 @@ int ssh_get_publickey_hash(const ssh_key key,
             goto out;
         }
 #endif
-        digest = md5;
+        digest = md5_direct;
         *hlen = MD5_DIGEST_LEN;
         break;
     default:
diff --git a/vendor/libssh/src/sntrup761.c b/vendor/libssh/src/sntrup761.c
index a67de43722..8873ed6c87 100644
--- a/vendor/libssh/src/sntrup761.c
+++ b/vendor/libssh/src/sntrup761.c
@@ -216,7 +216,7 @@ static int ssh_sntrup761x25519_build_k(ssh_session session)
     ssh_log_hexdump("kem key", ssk, SNTRUP761_SIZE);
 #endif
 
-    sha512(ssk, sizeof ssk, hss);
+    sha512_direct(ssk, sizeof ssk, hss);
 
     bignum_bin2bn(hss, sizeof hss, &session->next_crypto->shared_secret);
     if (session->next_crypto->shared_secret == NULL) {
