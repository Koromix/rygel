diff --git a/vendor/libssh/src/buffer.c b/vendor/libssh/src/buffer.c
index 449fa941c7..e00b094f32 100644
--- a/vendor/libssh/src/buffer.c
+++ b/vendor/libssh/src/buffer.c
@@ -28,7 +28,9 @@
 #include <stdbool.h>
 #include <stdio.h>
 
-#ifndef _WIN32
+#ifdef _WIN32
+#include <winsock2.h>
+#else
 #include <netinet/in.h>
 #include <arpa/inet.h>
 #endif
diff --git a/vendor/libssh/src/legacy.c b/vendor/libssh/src/legacy.c
index 65a47d6e63..edc950eb53 100644
--- a/vendor/libssh/src/legacy.c
+++ b/vendor/libssh/src/legacy.c
@@ -29,6 +29,10 @@
 #include <errno.h>
 #include <stdio.h>
 
+#ifdef _WIN32
+#include <winsock2.h>
+#endif
+
 #include <libssh/priv.h>
 #include <libssh/session.h>
 #include <libssh/server.h>
diff --git a/vendor/libssh/src/messages.c b/vendor/libssh/src/messages.c
index a9f5279f8a..3fa98dd329 100644
--- a/vendor/libssh/src/messages.c
+++ b/vendor/libssh/src/messages.c
@@ -26,7 +26,9 @@
 #include <string.h>
 #include <stdlib.h>
 
-#ifndef _WIN32
+#ifdef _WIN32
+#include <winsock2.h>
+#else
 #include <netinet/in.h>
 #include <arpa/inet.h>
 #endif
diff --git a/vendor/libssh/src/packet_cb.c b/vendor/libssh/src/packet_cb.c
index 54c94c8438..24f6c3e024 100644
--- a/vendor/libssh/src/packet_cb.c
+++ b/vendor/libssh/src/packet_cb.c
@@ -27,6 +27,9 @@
 #ifdef HAVE_ARPA_INET_H
 #include <arpa/inet.h>
 #endif
+#ifdef _WIN32
+#include <winsock2.h>
+#endif
 
 #include "libssh/priv.h"
 #include "libssh/buffer.h"
diff --git a/vendor/libssh/src/packet_crypt.c b/vendor/libssh/src/packet_crypt.c
index 96e9586c02..ad9ca4238a 100644
--- a/vendor/libssh/src/packet_crypt.c
+++ b/vendor/libssh/src/packet_crypt.c
@@ -27,7 +27,9 @@
 #include <stdio.h>
 #include <string.h>
 
-#ifndef _WIN32
+#ifdef _WIN32
+#include <winsock2.h>
+#else
 #include <netinet/in.h>
 #include <arpa/inet.h>
 #endif
diff --git a/vendor/libssh/src/pki.c b/vendor/libssh/src/pki.c
index a719d85f70..4bf87a2d8f 100644
--- a/vendor/libssh/src/pki.c
+++ b/vendor/libssh/src/pki.c
@@ -43,6 +43,10 @@
 #include <sys/stat.h>
 #include <sys/types.h>
 
+#ifdef _WIN32
+#include <winsock2.h>
+#endif
+
 #include "libssh/libssh.h"
 #include "libssh/session.h"
 #include "libssh/priv.h"
diff --git a/vendor/libssh/src/sftp_aio.c b/vendor/libssh/src/sftp_aio.c
index c1c54561ae..37eb5a6bad 100644
--- a/vendor/libssh/src/sftp_aio.c
+++ b/vendor/libssh/src/sftp_aio.c
@@ -25,6 +25,10 @@
 
 #include "config.h"
 
+#ifdef _WIN32
+#include <winsock2.h>
+#endif
+
 #include "libssh/sftp.h"
 #include "libssh/sftp_priv.h"
 #include "libssh/buffer.h"
diff --git a/vendor/libssh/src/sftp_common.c b/vendor/libssh/src/sftp_common.c
index 13512b8dbe..be284baaa8 100644
--- a/vendor/libssh/src/sftp_common.c
+++ b/vendor/libssh/src/sftp_common.c
@@ -28,6 +28,10 @@
 
 #include <ctype.h>
 
+#ifdef _WIN32
+#include <winsock2.h>
+#endif
+
 #include "libssh/sftp.h"
 #include "libssh/sftp_priv.h"
 #include "libssh/buffer.h"
diff --git a/vendor/libssh/src/string.c b/vendor/libssh/src/string.c
index 0ab9310c4e..e1e63fd0ac 100644
--- a/vendor/libssh/src/string.c
+++ b/vendor/libssh/src/string.c
@@ -26,7 +26,9 @@
 #include <errno.h>
 #include <limits.h>
 
-#ifndef _WIN32
+#ifdef _WIN32
+#include <winsock2.h>
+#else
 #include <netinet/in.h>
 #include <arpa/inet.h>
 #endif
diff --git a/vendor/libssh/src/ttyopts.c b/vendor/libssh/src/ttyopts.c
index a1ab31f0c7..546060e5b4 100644
--- a/vendor/libssh/src/ttyopts.c
+++ b/vendor/libssh/src/ttyopts.c
@@ -27,6 +27,10 @@
 #include <stdint.h>
 #include <stdio.h>
 
+#ifdef _WIN32
+#include <winsock2.h>
+#endif
+
 #include <libssh/priv.h>
 #include <string.h>
 
