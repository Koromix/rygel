<!DOCTYPE html>
<html lang="fr">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>{TITLE}</title>
        <link rel="icon" href="/static/favicon.png">

        <link rel="stylesheet" href="/static/main.css?{BUSTER}">
        <link rel="stylesheet" href="/static/print.css?{BUSTER}" media="print">
        <link rel="stylesheet" href="/static/opensans/OpenSans.css">

        <script type="text/javascript" src="/static/main.js?{BUSTER}" async></script>

        <style>
            #news {
                background: #112a2c;
                height: 256px;
                margin: 64px 0 1em 0;
                position: relative;
            }
            #news > img {
                position: absolute;
                width: 32px;
                height: 32px;
                top: calc(50% - 16px);
                cursor: pointer;
                z-index: 2;
            }
            #news > div {
                position: absolute;
                display: flex;
                padding-left: calc((100% - 1200px) / 2 + 16px);
                padding-right: calc((100% - 1200px) / 2 + 16px);
                opacity: 0;
                transition: opacity 0.26s ease;
                user-select: none;
                pointer-events: none;
            }
            #news > div.active {
                opacity: 1;
                user-select: auto;
                pointer-events: auto;
            }
            #news > div > img {
                margin-top: -64px;
                height: 320px;
            }
            #news > div > div {
                flex: 1;
                padding: 2em;
                color: white;
                --color: white;
            }
            #news > div p.title {
                font-size: 1.1em;
                font-weight: bold;
                margin-bottom: 1.4em;
            }

            #news div.big {
                display: block;
                position: absolute;
                left: 0;
                top: 256px;
                box-sizing: border-box;
                padding-left: max(1em, calc((100% - 1200px) / 2 + 16px));
                padding-right: max(1em, calc((100% - 1200px) / 2 + 16px));
                background: white;
                border-bottom: 2px solid #383838;
                z-index: 4;
                transform: scaleY(0);
                transform-origin: top;
                transition: transform 0.2s ease, color 0.4s ease, --color 0.4s ease;
            }
            #news.expand div.big {
                transform: scaleY(1);
                color: #383838;
                --color: #383838;
            }

            @media screen and (max-width: 960px) {
                #news {
                    height: 320px;
                    margin: 1em 0 0 0;
                    padding: 0;
                    background: none;
                    position: relative;
                }
                #news > img { top: calc(100% - 32px); }
                #news > div { height: 304px; }
                #news > div > img {
                    position: absolute;
                    width: 100%;
                    height: 100%;
                    margin-top: 0;
                    left: 0;
                    top: 0;
                    object-fit: cover;
                    z-index: -1;
                }
                #news > div > div {
                    padding: 2em 1em;
                    background: #112a2ccc;
                }
                #news > div p.title { margin-bottom: 0; }
            }

            @media print {
                #news { display: none; }
            }
        </style>
    </head>
    <body class="nojs">
        <a id="deploy" href="#" onclick="deploy(); return false;"></a>

        <nav id="top">
            <ul>
                <a id="logo" href="/"><img src="/static/logo.png" alt="Logo DEMHETER" /></a>

{LINKS}
            </ul>
        </nav>

        <div id="news">
            <img style="left: 16px;" src="/static/img/left.png" alt="" onclick="toggleNews(-1, true)" />
            <img style="right: 16px;" src="/static/img/right.png" alt="" onclick="toggleNews(1, true)" />

            <div class="active">
                <img src="/static/leaves.webp" alt="" />

                <div>
                    <p class="title">Nous recrutons !
                    <p>L'équipe DEMHETER recherche un.e psychologue prêt.e à s'investir dans des projets de recherche clinique portant sur les troubles de l'humeur. Temps plein, CDD d'1 an (renouvellement possible).

                    <p><a onclick="expandNews(event)">Lire la suite</a>
                </div>

                <div class="big">
                    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Euismod elementum nisi quis eleifend. Purus ut faucibus pulvinar elementum integer enim. Sollicitudin nibh sit amet commodo nulla facilisi nullam. Ut eu sem integer vitae justo eget magna fermentum. Pellentesque pulvinar pellentesque habitant morbi. Enim lobortis scelerisque fermentum dui faucibus. Sed elementum tempus egestas sed sed risus pretium. Montes nascetur ridiculus mus mauris vitae ultricies. Aenean pharetra magna ac placerat vestibulum. Vel risus commodo viverra maecenas accumsan.
                    <p>Ullamcorper velit sed ullamcorper morbi. Tristique senectus et netus et malesuada fames. Eget felis eget nunc lobortis mattis aliquam faucibus purus in. Nunc non blandit massa enim. Et netus et malesuada fames ac turpis. Pretium viverra suspendisse potenti nullam ac tortor vitae purus. Ac ut consequat semper viverra nam. Arcu non sodales neque sodales ut etiam sit amet. Varius quam quisque id diam. Nunc congue nisi vitae suscipit tellus mauris a diam maecenas. Faucibus pulvinar elementum integer enim neque volutpat ac tincidunt vitae. Et magnis dis parturient montes nascetur.
                    <p>Viverra accumsan in nisl nisi scelerisque. Dolor purus non enim praesent elementum facilisis leo vel fringilla. Cras ornare arcu dui vivamus arcu felis. Turpis tincidunt id aliquet risus feugiat in. Senectus et netus et malesuada fames. Quam id leo in vitae turpis massa sed elementum. Malesuada fames ac turpis egestas maecenas pharetra convallis. Praesent tristique magna sit amet purus. Risus in hendrerit gravida rutrum quisque non tellus orci ac. Ultrices sagittis orci a scelerisque purus semper. Semper quis lectus nulla at volutpat diam. Nunc sed blandit libero volutpat sed. Suscipit tellus mauris a diam maecenas.
                    <p>Amet mauris commodo quis imperdiet massa tincidunt nunc pulvinar. Ipsum a arcu cursus vitae congue. Nibh tellus molestie nunc non blandit. Sollicitudin nibh sit amet commodo nulla. Suspendisse faucibus interdum posuere lorem ipsum dolor sit amet. Tristique sollicitudin nibh sit amet commodo nulla. Aliquet nibh praesent tristique magna sit amet purus gravida. Tellus pellentesque eu tincidunt tortor. In arcu cursus euismod quis viverra nibh cras pulvinar mattis. Gravida arcu ac tortor dignissim convallis. Ut enim blandit volutpat maecenas volutpat blandit aliquam etiam erat. Ut aliquam purus sit amet. Egestas pretium aenean pharetra magna ac placerat vestibulum.
                    <p>Consectetur adipiscing elit duis tristique sollicitudin nibh sit. Aenean pharetra magna ac placerat vestibulum lectus mauris ultrices. Semper eget duis at tellus. Non tellus orci ac auctor. Amet risus nullam eget felis eget. Faucibus pulvinar elementum integer enim neque volutpat ac. Dui accumsan sit amet nulla facilisi morbi tempus. Volutpat odio facilisis mauris sit amet massa. Vitae congue eu consequat ac felis donec et odio. Purus semper eget duis at. Amet volutpat consequat mauris nunc congue nisi. Ultrices mi tempus imperdiet nulla. Nulla aliquet porttitor lacus luctus accumsan tortor posuere ac ut. Ornare suspendisse sed nisi lacus sed viverra tellus. Id consectetur purus ut faucibus. Aliquet bibendum enim facilisis gravida neque convallis a. Nunc faucibus a pellentesque sit amet porttitor.
                    <p><a onclick="expandNews(event, false)">Replier l'onglet</a>
                </div>
            </div>

            <div>
                <img src="/static/misc/sun.jpg" alt="" />

                <div>
                    <p class="title">Le soleil brille !
                    <p>Le Soleil est l’étoile du Système solaire. C’est une étoile de type naine jaune, composée à 75% d’hydrogène et 25% d’hélium.
                    <p>Autour de lui gravitent la Terre, sept autres planètes, au moins cinq planètes naines, et de très nombreux astéroïdes et comètes et une bande de poussière.
                </div>
            </div>
        </div>

        <main>{CONTENT}</main>

        <footer>
            <div>DEMHETER © 2022</div>
            <img src="/static/logo.png" alt="" width="300">
            <div style="font-size: 0.8em;">
                CHU de Lille, 59037 Lille CEDEX<br>
                <a href="mailto:demheter@chu-lille.fr" style="font-weight: bold; color: inherit;">demheter@chu-lille.fr</a>
            </div>
        </footer>

        <script>
            let news_timer = null;

            resetTimer(false);

            function toggleNews(delta, explicit) {
                let news = document.querySelector('#news');

                if (explicit || !news.classList.contains('expand')) {
                    let divs = Array.from(document.querySelectorAll('#news > div'));
                    let idx = divs.findIndex(div => div.classList.contains('active'));

                    if (delta < 0) {
                        if (--idx < 0)
                            idx = divs.length - 1;
                    } else if (delta > 0) {
                        if (++idx >= divs.length)
                            idx = 0;
                    }

                    for (let i = 0; i < divs.length; i++) {
                        let div = divs[i];
                        div.classList.toggle('active', i == idx);
                    }

                    news.classList.remove('expand');
                }

                resetTimer(explicit);
            }

            function expandNews(e, enable = undefined) {
                let news = document.querySelector('#news');
                news.classList.toggle('expand', enable);

                resetTimer(false);
            }

            function resetTimer(explicit) {
                if (news_timer != null)
                    clearTimeout(news_timer);
                news_timer = setTimeout(() => toggleNews(1, false), explicit ? 15000 : 5000);
            }
        </script>
    </body>
</html>
